!function(){var e=document.createElement("style");e.innerHTML=".hope-ui-dark .hope-c-PJLV-ifjOQLV-css{background-color:rgba(0,0,0,.1)!important;backdrop-filter:blur(10px)!important}.hope-ui-light .hope-c-PJLV-ifjOQLV-css{background-color:rgba(255,255,255,.2)!important;backdrop-filter:blur(10px)!important}\n",document.head.appendChild(e),System.register(["./index-legacy.ebd850b2.js","./useTitle-legacy.571980d5.js","./webauthn-json.browser-ponyfill-legacy.8ddd819a.js"],(function(e){"use strict";var t,r,n,o,a,i,c,s,l,u,p,d,g,f,h,m,b,v,y,w,x,_,k,S,C,I,$,j,E,O,P,T,G,N,U,L,R,z,A,M,V,B,D,J,H,Z,q,F,K,Q;return{setters:[e=>{t=e.c8,r=e.E,n=e.c9,o=e.ca,a=e.aH,i=e.X,c=e.h,s=e.a7,l=e.aE,u=e.U,p=e.b,d=e.c4,g=e.cb,f=e.e,h=e.aB,m=e.b6,b=e.bV,v=e.cc,y=e.cd,w=e.ce,x=e.cf,_=e.a,k=e.k,S=e.m,C=e.cg,I=e.aT,$=e.a4,j=e.bO,E=e.ar,O=e.bN,P=e.S,T=e.I,G=e.ch,N=e.b2,U=e.aq,L=e.C,R=e.bh,z=e.bi,A=e.ag,M=e.ci,V=e.av,B=e.bE,D=e.n,J=e.b7,H=e.c,Z=e.cj},e=>{q=e.a},e=>{F=e.s,K=e.g,Q=e.a}],execute:function(){var X=a('<svg version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink height=896 width=967.8852157128662><defs><path id=path-2 opacity=1 fill-rule=evenodd d="M896,448 C1142.6325445712241,465.5747656464056 695.2579309733121,896 448,896 C200.74206902668806,896 5.684341886080802e-14,695.2579309733121 0,448.0000000000001 C0,200.74206902668806 200.74206902668791,5.684341886080802e-14 447.99999999999994,0 C695.2579309733121,0 475,418 896,448Z"></path><linearGradient id=linearGradient-3 x1=0.5 y1=0 x2=0.5 y2=1><stop offset=0 stop-opacity=1></stop><stop offset=1 stop-opacity=1></stop></linearGradient></defs><g opacity=1><use xlink:href=#path-2 fill=url(#linearGradient-3) fill-opacity=1>');const W=e=>{const t=r({startColor:"#28aff0",endColor:"#120fc4"},e);return a=X(),i=a.firstChild.firstChild.nextSibling.firstChild,c=i.nextSibling,n((e=>{var r=t.startColor,n=t.endColor;return r!==e.e&&o(i,"stop-color",e.e=r),n!==e.t&&o(c,"stop-color",e.t=n),e}),{e:void 0,t:void 0}),a;var a,i,c};var Y=a('<svg height=1337 width=1337><defs><path id=path-1 opacity=1 fill-rule=evenodd d="M1337,668.5 C1337,1037.455193874239 1037.455193874239,1337 668.5,1337 C523.6725684305388,1337 337,1236 370.50000000000006,1094 C434.03835568300906,824.6732385973953 6.906089672974592e-14,892.6277623047779 0,668.5000000000001 C0,299.5448061257611 299.5448061257609,1.1368683772161603e-13 668.4999999999999,0 C1037.455193874239,0 1337,299.544806125761 1337,668.5Z"></path><linearGradient id=linearGradient-2 x1=0.79 y1=0.62 x2=0.21 y2=0.86><stop offset=0 stop-opacity=1></stop><stop offset=1 stop-opacity=1></stop></linearGradient></defs><g opacity=1><use xlink:href=#path-1 fill=url(#linearGradient-2) fill-opacity=1>');const ee=e=>{const t=r({startColor:"#28aff0",endColor:"#120fc4"},e);return a=Y(),i=a.firstChild.firstChild.nextSibling.firstChild,c=i.nextSibling,n((e=>{var r=t.startColor,n=t.endColor;return r!==e.e&&o(i,"stop-color",e.e=r),n!==e.t&&o(c,"stop-color",e.t=n),e}),{e:void 0,t:void 0}),a;var a,i,c},te=()=>{const e=i("#a9c6ff","#062b74");return c(s,{get bgColor(){return e()},pos:"fixed",top:"0",left:"0",overflow:"hidden",zIndex:"-1",w:"100vw",h:"100vh",get children(){return[c(s,{pos:"absolute",right:{"@initial":"-100px","@sm":"-300px"},top:{"@initial":"-1170px","@sm":"-900px"},get children(){return c(ee,{})}}),c(s,{pos:"absolute",left:{"@initial":"-100px","@sm":"-200px"},bottom:{"@initial":"-760px","@sm":"-400px"},get children(){return c(W,{})}})]}})},re=()=>{const e=l("sso_login_enabled"),t=u("sso_login_platform"),r=l("sso_compatibility_mode"),{searchParams:n,to:o}=p(),a=n.token;function i(e){const t=e.data;t.token&&(d(t.token),o(decodeURIComponent(n.redirect||g||"/"),!0))}if(null!=a&&""!=a&&(d(a),o(decodeURIComponent(n.redirect||g||"/"),!0)),window.addEventListener("message",i),f((()=>{window.removeEventListener("message",i)})),e){const e=()=>{const e=m.getUri()+"/auth/sso?method=sso_get_token";r?window.location.href=e:window.open(e,"authPopup","width=500,height=600")};let n;switch(t){case"Github":n=x;break;case"Microsoft":n=w;break;case"Google":n=y;break;case"Dingtalk":n=v;break;default:n=b}return c(h,{cursor:"pointer",boxSize:"$8",as:n,p:"$0_5",onclick:e})}};!function(e){if(void 0===e)throw new Error("Geetest requires browser environment");var t=e.document,r=e.Math,n=t.getElementsByTagName("head")[0];function o(e){this._obj=e}o.prototype={_each:function(e){var t=this._obj;for(var r in t)t.hasOwnProperty(r)&&e(r,t[r]);return this},_extend:function(e){var t=this;new o(e)._each((function(e,r){t._obj[e]=r}))}};function a(e){var t=this;new o(e)._each((function(e,r){t[e]=r}))}a.prototype={apiServers:["gcaptcha4.geetest.com","gcaptcha4.geevisit.com","gcaptcha4.gsensebot.com"],staticServers:["static.geetest.com","static.geevisit.com"],protocol:"http://",typePath:"/load",fallback_config:{bypass:{staticServers:["static.geetest.com","static.geevisit.com"],type:"bypass",bypass:"/v4/bypass.js"}},_get_fallback_config:function(){var e=this;return i(e.type)?e.fallback_config[e.type]:e.fallback_config.bypass},_extend:function(e){var t=this;new o(e)._each((function(e,r){t[e]=r}))}};var i=function(e){return"string"==typeof e},c=function(e){return"function"==typeof e},s=/Mobi/i.test(navigator.userAgent),l={},u={},p=Object.prototype.toString;function d(e,t){if((r=e)!==Object(r)||function(e){return"[object Date]"==p.call(e)}(e)||function(e){return"[object RegExp]"==p.call(e)}(e)||function(e){return"[object Boolean]"==p.call(e)}(e)||function(e){return"function"==typeof e}(e))return t?function(e){return e.replace(/(\S)(_([a-zA-Z]))/g,(function(e,t,r,n){return t+n.toUpperCase()||""}))}(e):e;var r;if(function(e){return"[object Array]"==p.call(e)}(e))for(var n=[],o=0;o<e.length;o++)n.push(d(e[o]));else{n={};for(var a in e)e.hasOwnProperty(a)&&(n[d(a,!0)]=d(e[a]))}return n}var g=function(e,t,r,n){t=function(e){return e.replace(/^https?:\/\/|\/$/g,"")}(t);var a=function(e){return 0!==(e=e&&e.replace(/\/+/g,"/")).indexOf("/")&&(e="/"+e),e}(r)+function(e){if(!e)return"";var t="?";return new o(e)._each((function(e,r){(i(r)||function(e){return"number"==typeof e}(r)||function(e){return"boolean"==typeof e}(r))&&(t=t+encodeURIComponent(e)+"="+encodeURIComponent(r)+"&")})),"?"===t&&(t=""),t.replace(/&$/,"")}(n);return t&&(a=e+t+a),a},f=function(o,a,i,c,s,l,u){var p=function(d){if(u){var f="geetest_"+(parseInt(1e4*r.random())+(new Date).valueOf());e[f]=function(e,t){if("function"==typeof e){var r=Array.prototype.slice.call(arguments,2);return Function.prototype.bind?e.bind(t,r):function(){var n=Array.prototype.slice.call(arguments);return e.apply(t,r.concat(n))}}}(u,null,f),s.callback=f}!function(e,r,o){var a=t.createElement("script");a.charset="UTF-8",a.async=!0,/static\.geetest\.com/g.test(e)&&(a.crossOrigin="anonymous"),a.onerror=function(){r(!0),i=!0};var i=!1;a.onload=a.onreadystatechange=function(){i||a.readyState&&"loaded"!==a.readyState&&"complete"!==a.readyState||(i=!0,setTimeout((function(){r(!1)}),0))},a.src=e,n.appendChild(a),setTimeout((function(){i||(a.onerror=a.onload=null,a.remove&&a.remove(),r(!0))}),o||1e4)}(g(a,i[d],c,s),(function(t){if(t){if(f)try{e[f]=function(){e[f]=null}}catch(r){}d>=i.length-1?l(!0):p(d+1)}else l(!1)}),o.timeout)};p(0)},h=function(e,t,r){if("function"!=typeof t.onError)throw new Error({networkError:"网络错误",gtTypeError:"gt字段不是字符串类型"}[e]);t.onError({desc:r.desc,msg:r.msg,code:r.code})};(e.Geetest||t.getElementById("gt_lib"))&&(u.slide="loaded");e.initGeetest4=function(n,i){var p,g=new a(n);n.https?g.protocol="https://":n.protocol||(g.protocol=e.location.protocol+"//"),"object"==typeof(p=n.getType)&&null!==p&&g._extend(n.getType),function(t,n,o,a){f(o,o.protocol,t,n,{callback:"",captcha_id:o.captchaId,challenge:o.challenge||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*r.random()|0;return("x"===e?t:3&t|8).toString(16)})),client_type:s?"h5":"web",risk_type:o.riskType,user_info:o.userInfo,call_type:o.callType,lang:o.language?o.language:"Netscape"===navigator.appName?navigator.language.toLowerCase():navigator.userLanguage.toLowerCase()},(function(e){e&&"function"==typeof o.offlineCb?o.offlineCb():e&&a(o._get_fallback_config())}),(function(t,r){"success"==r.status?a(r.data):(r.status,a(r)),e[t]=void 0;try{delete e[t]}catch(n){}}))}(g.apiServers,g.typePath,g,(function(r){if("error"===(r=d(r)).status)return h("networkError",g,r);var n=r.type;g.debug&&new o(r)._extend(g.debug);var a=function(){g._extend(r),i(new e.Geetest4(g))};l[n]=l[n]||[];var s=u[n]||"init";if("init"===s)u[n]="loading",l[n].push(a),r.gctPath&&f(g,g.protocol,Object.hasOwnProperty.call(g,"staticServers")?g.staticServers:r.staticServers||g.staticServers,r.gctPath,null,(function(e){e&&h("networkError",g,{code:"60205",msg:"Network failure",desc:{detail:"gct resource load timeout"}})})),f(g,g.protocol,Object.hasOwnProperty.call(g,"staticServers")?g.staticServers:r.staticServers||g.staticServers,r.bypass||r.staticPath+r.js,null,(function(e){if(e)u[n]="fail",h("networkError",g,{code:"60204",msg:"Network failure",desc:{detail:"js resource load timeout"}});else{u[n]="loaded";for(var t=l[n],r=0,o=t.length;r<o;r+=1){var a=t[r];c(a)&&a()}l[n]=[],u[n]="init"}}));else{if("loaded"===s)return r.gctPath&&!function(e){var r=!1,n=e&&{js:"script",css:"link"}[e.split(".").pop()];if(void 0!==n){var o=t.getElementsByTagName(n);for(var a in o)(o[a].href&&o[a].href.toString().indexOf(e)>0||o[a].src&&o[a].src.toString().indexOf(e)>0)&&(r=!0)}return r}(r.gctPath)&&f(g,g.protocol,Object.hasOwnProperty.call(g,"staticServers")?g.staticServers:r.staticServers||g.staticServers,r.gctPath,null,(function(e){e&&h("networkError",g,{code:"60205",msg:"Network failure",desc:{detail:"gct resource load timeout"}})})),a();"fail"===s?h("networkError",g,{code:"60204",msg:"Network failure",desc:{detail:"js resource load timeout"}}):"loading"===s&&l[n].push(a)}}))}}(window);var ne=a("<div id=captcha>");e("default",(()=>{const e=u("logo").split("\n"),r=i(e[0],e.pop()),n=_(),o=k((()=>`${u("site_title")}`));q(o);const a=i("white","$neutral1"),[s,f]=S(localStorage.getItem("username")||""),[b,v]=S(localStorage.getItem("lot_number")||""),[y,w]=S(localStorage.getItem("captcha_output")||""),[x,X]=S(localStorage.getItem("pass_token")||""),[W,Y]=S(localStorage.getItem("gen_time")||""),[ee,oe]=S(localStorage.getItem("sign_token")||""),[ae,ie]=S(localStorage.getItem("password")||""),[ce,se]=S(""),[le,ue]=S(!1),[pe,de]=C("remember-pwd","false"),[ge,fe]=S(!1),[he,me]=I((async()=>{const e=localStorage.getItem("captcha");return e&&JSON.parse(e),ge()?m.post("/auth/login/ldap",{username:s(),password:ae(),otp_code:ce()}):m.post("/auth/login/hash",{username:s(),password:(r=ae(),t(`${r}-https://github.com/alist-org/alist`)),otp_code:ce(),lot_number:b(),captcha_output:y(),pass_token:x(),gen_time:W(),sign_token:ee()});var r})),[,be]=I(((e,t,r)=>m.post("/authn/webauthn_finish_login?username="+r,JSON.stringify(t),{headers:{session:e}}))),[,ve]=I((e=>m.get("/authn/webauthn_begin_login?username="+e))),{searchParams:ye,to:we}=p(),xe=l("webauthn_login_enabled"),_e=async()=>{ue(!le())},ke=async()=>{if(le()){if(!F())return void D.error(n("users.webauthn_not_supported"));d(),"true"===pe()?localStorage.setItem("username",s()):localStorage.removeItem("username");const e=await ve(s());J(e,(async e=>{try{const t=K(e.options),r=await Q(t),o=await be(e.session,r,s());B(o,(e=>{D.success(n("login.success")),d(e.token),we(decodeURIComponent(ye.redirect||g||"/"),!0)}))}catch(t){t instanceof Error&&D.error(t.message)}}))}else{"true"===pe()?(localStorage.setItem("username",s()),localStorage.setItem("password",ae())):(localStorage.removeItem("username"),localStorage.removeItem("password"));const e=await me();B(e,(e=>{D.success(n("login.success")),d(e.token),we(decodeURIComponent(ye.redirect||g||"/"),!0)}),((e,t)=>{Se()||402!==t?D.error(e):Ce(!0)}))}},[Se,Ce]=S(!1),Ie=l("ldap_login_enabled"),$e=u("ldap_login_tips");Ie&&fe(!0);const je=()=>{(async function(e){try{return(await H.get(e)).data}catch(t){throw D.error(t),t}})(Z+"/api/auth/need_captcha").then((e=>{e.need_captcha,!0===e.need_captcha?initGeetest4({captchaId:"ddd701191607e83c9d8d87020099d5aa",product:"popup"},(function(e){e.appendTo("#captcha"),e.onReady((function(){})).onSuccess((function(){let t=e.getValidate();v(t.lot_number),w(t.captcha_output),X(t.pass_token),Y(t.gen_time),oe(t.sign_token),ke()})).onError((function(){D.error("肥鸡验证失败")}))})):ke()})).catch((e=>{D.error("肥鸡验证失败")}))};return c(V,{zIndex:"1",w:"$full",h:"100vh",get children(){return[c($,{get bgColor(){return a()},rounded:"$xl",p:"24px",w:{"@initial":"90%","@sm":"364px"},spacing:"$4",get children(){return[c(j,{alignItems:"center",justifyContent:"space-around",get children(){return[c(E,{mr:"$2",boxSize:"$12",get src(){return r()}}),c(O,{color:"$info9",fontSize:"$2xl",get children(){return o()}})]}}),c(P,{get when(){return!Se()},get fallback(){return c(T,{id:"totp",name:"otp",get placeholder(){return n("login.otp-tips")},get value(){return ce()},onInput:e=>se(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&ke()}})},get children(){return[c(T,{name:"username",get placeholder(){return n("login.username-tips")},get value(){return s()},onInput:e=>f(e.currentTarget.value)}),c(P,{get when(){return!le()},get children(){return c(T,{name:"password",get placeholder(){return n("login.password-tips")},type:"password",get value(){return ae()},onInput:e=>ie(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&ke()}})}}),c(j,{px:"$1",w:"$full",fontSize:"$sm",color:"$neutral10",justifyContent:"space-between",alignItems:"center",get children(){return[c(G,{get checked(){return"true"===pe()},onChange:()=>de("true"===pe()?"false":"true"),get children(){return n("login.remember")}}),c(N,{as:"a",target:"_blank",get href(){return n("login.forget_url")},get children(){return n("login.forget")}})]}})]}}),c(U,{w:"$full",spacing:"$2",get children(){return[c(P,{get when(){return!le()},get children(){return c(L,{colorScheme:"primary",w:"$full",onClick:()=>{Se()?se(""):(f(""),ie(""))},get children(){return n("login.clear")}})}}),c(L,{w:"$full",get loading(){return he()},class:"g-recaptcha","data-sitekey":"reCAPTCHA_site_key","data-callback":"onSubmit","data-action":"submit",onclick:je,get children(){return n("login.login")}})]}}),c(P,{when:Ie,get children(){return c(G,{w:"$full",get checked(){return!0===ge()},onChange:()=>fe(!ge()),children:$e})}}),c(L,{w:"$full",colorScheme:"accent",onClick:()=>{d(),we(decodeURIComponent(ye.redirect||g||"/"),!0)},get children(){return n("login.use_guest")}}),ne(),c(j,{mt:"$2",justifyContent:"space-evenly",alignItems:"center",color:"$neutral10",w:"$full",get children(){return[c(R,{}),c(z,{}),c(re,{}),c(P,{when:xe,get children(){return c(h,{cursor:"pointer",boxSize:"$8",get color(){return A()},as:M,p:"$0_5",onclick:_e})}})]}})]}}),c(te,{})]}})}))}}}))}();
